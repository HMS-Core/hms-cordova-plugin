{"version":3,"file":"HMSNativeAd.js","sourceRoot":"","sources":["../src/www/HMSNativeAd.ts"],"names":[],"mappings":"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","sourcesContent":["import {\r\n    LayoutBounds,\r\n    NativeAdLoadOptions,\r\n    NativeAdOptions,\r\n    Props,\r\n    VideoOperatorAspectRatio,\r\n    NativeAdConfiguration\r\n} from './interfaces'\r\nimport { getInitialPropsOfHTMLElementFrom } from './layout'\r\nimport { NativeAdEvents } from './HMSConstants'\r\nimport { Ads } from './ads'\r\n\r\n\r\nconst nativeViews = new Map<string, HMSNativeAd>()\r\nexport class NativeAlreadyDefinedError extends Error {\r\n    constructor() {\r\n        super()\r\n        this.name = \"NativeAlreadyDefinedError\"\r\n        this.message = \"Native object with the id specified already defined\"\r\n    }\r\n}\r\nexport class HMSNativeAd extends Ads {\r\n    public divId: string = \"\";\r\n    public element: HTMLElement | null = null;\r\n    public nativeCurrentProps: Props;\r\n    constructor() {\r\n        super(HMSNativeAd.name.toLowerCase())\r\n        this.nativeCurrentProps = {} as Props;\r\n    }\r\n\r\n    on(eventName: NativeAdEvents, callback: () => void): void {\r\n        super.on(eventName, callback);\r\n    }\r\n\r\n    async create(options: NativeAdOptions, bounds?: LayoutBounds): Promise<HMSNativeAd> {\r\n        this.divId = options.div\r\n        if (nativeViews.has(options.div))\r\n            throw new NativeAlreadyDefinedError()\r\n\r\n        nativeViews.set(options.div, this)\r\n        this.element = document.getElementById(this.divId);\r\n        const nativeMutationObserver = new MutationObserver(() => {\r\n            if (this.element != null) {\r\n                this.forceUpdateNativeXAndY();\r\n            }\r\n        });\r\n\r\n        const config = { attributes: true, childList: true, subtree: true };\r\n        nativeMutationObserver.observe(document.body, config);\r\n\r\n        const initialProps: any = getInitialPropsOfHTMLElementFrom(options.div);\r\n        if (bounds) {\r\n            if (bounds.marginRight) initialProps['marginRight'] = bounds.marginRight;\r\n            if (bounds.marginTop) initialProps['marginTop'] = bounds.marginTop;\r\n            if (bounds.marginBottom) initialProps['marginBottom'] = bounds.marginBottom;\r\n            if (bounds.marginLeft) initialProps['marginLeft'] = bounds.marginLeft;\r\n        }\r\n        this.nativeCurrentProps = initialProps;\r\n        return <Promise<HMSNativeAd>>super.create(initialProps, options);\r\n    }\r\n\r\n    scroll(): void {\r\n        if (this.element === null) return;\r\n        const nativeRect = this.element.getBoundingClientRect();\r\n        if (this.nativeCurrentProps.x === nativeRect.x && this.nativeCurrentProps.y === nativeRect.y) return;\r\n        this.run('scroll', { 'scrolledX': nativeRect.x, 'scrolledY': nativeRect.y});\r\n    }\r\n\r\n    private forceUpdateNativeXAndY() {\r\n        if (this.element === null) return;\r\n        const nativeRect = this.element.getBoundingClientRect();\r\n        this.run('forceUpdateNativeXAndY', { 'scrolledX': nativeRect.x, 'scrolledY': nativeRect.y,\r\n            'pageYOffset': window.pageYOffset, 'pageXOffset': window.pageXOffset});\r\n    }\r\n\r\n    loadAd(options: NativeAdLoadOptions = {}): Promise<void> {\r\n        return this.run('loadAd', options)\r\n    }\r\n\r\n    show(): Promise<void> {\r\n        return this.run('show')\r\n    }\r\n\r\n    isLoading(): Promise<boolean> {\r\n        return this.run('isLoading')\r\n    }\r\n\r\n    destroy(): Promise<void> {\r\n        nativeViews.delete(this.divId)\r\n        return this.run('destroy')\r\n    }\r\n\r\n    dislikeAd(dislikeReason: string): Promise<void> {\r\n        return this.run('dislikeAd', { 'dislikeAdReason': dislikeReason })\r\n    }\r\n    setAllowCustomClick(): Promise<void> {\r\n        return this.run('setAllowCustomClick')\r\n    }\r\n    getAdSource(): Promise<string> {\r\n        return this.run('getAdSource')\r\n    }\r\n    getDescription(): Promise<string> {\r\n        return this.run('getDescription')\r\n    }\r\n    getCallToAction(): Promise<string> {\r\n        return this.run('getCallToAction')\r\n    }\r\n    getDislikeAdReasons(): Promise<string[]> {\r\n        return this.run('getDislikeAdReasons')\r\n    }\r\n    isCustomClickAllowed(): Promise<boolean> {\r\n        return this.run('isCustomClickAllowed')\r\n    }\r\n\r\n    isCustomDislikeThisAdEnabled(): Promise<boolean> {\r\n        return this.run('isCustomDislikeThisAdEnabled')\r\n    }\r\n    recordClickEvent(): Promise<void> {\r\n        return this.run('recordClickEvent')\r\n    }\r\n    recordImpressionEvent(impressionData: any): Promise<boolean> {\r\n        return this.run('recordImpressionEvent', impressionData)\r\n    }\r\n\r\n    getUniqueId(): Promise<string> {\r\n        return this.run('getUniqueId')\r\n    }\r\n    setDislikeAdListener(): Promise<void> {\r\n        return this.run('setDislikeAdListener')\r\n    }\r\n    gotoWhyThisAdPage(useView: boolean): Promise<void> {\r\n        return this.run('gotoWhyThisAdPage', { \"useView\": useView })\r\n    }\r\n\r\n    getAdSign(): Promise<string> {\r\n        return this.run('getAdSign')\r\n    }\r\n\r\n    getTitle(): Promise<string> {\r\n        return this.run('getTitle')\r\n    }\r\n\r\n\r\n    getWhyThisAd(): Promise<string> {\r\n        return this.run('getWhyThisAd')\r\n    }\r\n\r\n    recordShowStartEvent(showStartData: any): Promise<boolean> {\r\n        return this.run('recordShowStartEvent', showStartData)\r\n    }\r\n\r\n    onAdClose(keywords: string[]): Promise<void> {\r\n        return this.run('onAdClose', { 'keywords': keywords })\r\n    }\r\n    getNativeAdConfiguration(): Promise<NativeAdConfiguration> {\r\n        return this.run('getNativeAdConfiguration')\r\n    }\r\n\r\n    // VideoOperator\r\n    videoOperatorGetAspectRatio(): Promise<VideoOperatorAspectRatio> {\r\n        return this.run('videoOperatorGetAspectRatio')\r\n    }\r\n    videoOperatorHasVideo(): Promise<boolean> {\r\n        return this.run('videoOperatorHasVideo')\r\n    }\r\n    videoOperatorIsCustomizeOperateEnabled(): Promise<boolean> {\r\n        return this.run('videoOperatorIsCustomizeOperateEnabled')\r\n    }\r\n    videoOperatorIsMuted(): Promise<boolean> {\r\n        return this.run('videoOperatorIsMuted')\r\n    }\r\n    videoOperatorMute(mute: boolean): Promise<void> {\r\n        return this.run('videoOperatorMute', { \"mute\": mute })\r\n    }\r\n    videoOperatorPause(): Promise<void> {\r\n        return this.run('videoOperatorPause')\r\n    }\r\n    videoOperatorPlay(): Promise<void> {\r\n        return this.run('videoOperatorPlay')\r\n    }\r\n    videoOperatorStop(): Promise<void> {\r\n        return this.run('videoOperatorStop')\r\n    }\r\n}\r\n"]}